"use strict";(function(){var f;var e;var b;var v;var t;var o={lineColor:[1,0,0],backColor:[0.03,0.03,0.03],tint:0.01,lineCount:400,speed:0.15,cycle:true,customCycleVal:0,customCycleSpeed:0,cycleSpeed:0.005,cycleVal:0,pixelDiv:3,irradiance:0.5,programMode:0,fps:0};const d=20480;function p(){e=document.createElement("canvas");e.style.width="100%";e.style.height="100%";var N=document.getElementsByTagName("script");var O=N[N.length-1];O.parentNode.insertBefore(e,O);var P=e.getBoundingClientRect();e.width=P.width/o.pixelDiv;e.height=P.height/o.pixelDiv;t=true;e.addEventListener("webglcontextlost",i,false);e.addEventListener("webglcontextrestored",c,false);return e}function H(R){f=R.getContext("webgl",{antialias:false,preserveDrawingBuffer:true});var au=f.getExtension("OES_vertex_array_object");f.clearColor(0.04,0.04,0.04,1);f.clear(f.COLOR_BUFFER_BIT);var ak=f.createShader(f.VERTEX_SHADER);f.shaderSource(ak,g);f.compileShader(ak);var al=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(al,m);f.compileShader(al);var U=f.createProgram();f.attachShader(U,ak);f.attachShader(U,al);f.bindAttribLocation(U,0,"position");f.linkProgram(U);var V=f.getAttribLocation(U,"position");var ap=f.getUniformLocation(U,"modelViewMatrix");var T=f.getUniformLocation(U,"projectionMatrix");var N=f.getUniformLocation(U,"color");var O=f.getUniformLocation(U,"time");var ao=f.getUniformLocation(U,"cycle");var ac=f.getUniformLocation(U,"amount");var ag=f.createShader(f.VERTEX_SHADER);f.shaderSource(ag,J);f.compileShader(ag);var Z=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(Z,B);f.compileShader(Z);var at=f.createProgram();f.attachShader(at,ag);f.attachShader(at,Z);f.bindAttribLocation(at,0,"position");f.linkProgram(at);f.useProgram(at);f.uniform2f(f.getUniformLocation(at,"screenSize"),R.width,R.height);f.uniform1i(f.getUniformLocation(at,"texture"),0);var ah=f.getUniformLocation(at,"time");f.useProgram(null);var aj=L();var X=new Float32Array([-1,-1,1,-1,-1,1,1,1]);var Q=au.createVertexArrayOES();var ab=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,ab);f.bufferData(f.ARRAY_BUFFER,X,f.STATIC_DRAW);au.bindVertexArrayOES(Q);f.vertexAttribPointer(0,2,f.FLOAT,false,0,0);f.bindBuffer(f.ARRAY_BUFFER,null);f.enableVertexAttribArray(0);au.bindVertexArrayOES(null);var an=I(R.width,R.height);var aw=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var Y=f.createBuffer();var av=au.createVertexArrayOES();f.bindBuffer(f.ARRAY_BUFFER,Y);au.bindVertexArrayOES(av);f.vertexAttribPointer(V,3,f.FLOAT,false,0,0);au.bindVertexArrayOES(null);f.bindBuffer(f.ARRAY_BUFFER,null);au.bindVertexArrayOES(av);f.enableVertexAttribArray(V);au.bindVertexArrayOES(null);f.useProgram(U);f.uniformMatrix4fv(T,false,an);f.uniformMatrix4fv(ap,false,aw);f.uniform3f(N,1,0,0);f.useProgram(null);window.addEventListener("resize",ar,false);b=requestAnimationFrame(aa);var af=Date.now();var ai=0;var ae=0;var P=0;var aq=0;var ad=0;var W=0;o.cycleVal=Math.random();function aa(ay){ae=(ay-ai)/1000;ai=ay;P+=ae*o.speed;if(o.fps>0){aq+=ae;if(aq<1/o.fps){b=requestAnimationFrame(aa);return}aq-=1/o.fps}h(ae);A();f.bindBuffer(f.ARRAY_BUFFER,Y);if(n.length>u){u=Math.ceil(n.length/d)*d;f.bufferData(f.ARRAY_BUFFER,u*4,f.STREAM_DRAW)}f.bufferSubData(f.ARRAY_BUFFER,0,n);f.bindBuffer(f.ARRAY_BUFFER,null);if(o.cycle){C(ae)}var ax=o.backColor,aB=o.lineColor,aA=o.tint;var az=[k(ax[0]+aB[0]*aA,0,1),k(ax[1]+aB[1]*aA,0,1),k(ax[2]+aB[2]*aA,0,1)];if(o.programMode==1){o.cycleSpeed=o.customCycleSpeed}else{if(o.programMode==2){o.cycleVal=o.customCycleVal}}f.clearColor(az[0],az[1],az[2],1);f.clear(f.COLOR_BUFFER_BIT);f.bindFramebuffer(f.FRAMEBUFFER,aj.buffer);f.clearColor(az[0],az[1],az[2],0.6);f.clear(f.COLOR_BUFFER_BIT);f.bindFramebuffer(f.FRAMEBUFFER,null);if(!t||z==0){b=requestAnimationFrame(aa);return}f.enable(f.BLEND);f.useProgram(U);f.uniform3f(N,aB[0],aB[1],aB[2]);f.uniform1f(O,(P));f.uniform1f(ao,o.cycleVal);f.uniform1f(ac,o.irradiance);au.bindVertexArrayOES(av);f.bindFramebuffer(f.FRAMEBUFFER,aj.buffer);f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA);f.drawArrays(f.TRIANGLES,0,z/3);au.bindVertexArrayOES(null);f.bindFramebuffer(f.FRAMEBUFFER,null);f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA);au.bindVertexArrayOES(Q);f.useProgram(at);f.uniform1f(ah,(P)%100);f.bindTexture(f.TEXTURE_2D,aj.texture);f.drawArrays(f.TRIANGLE_STRIP,0,4);f.disable(f.BLEND);f.useProgram(null);au.bindVertexArrayOES(null);b=requestAnimationFrame(aa)}var am=null;function ar(){if(am!=null){window.clearTimeout(am);am=null}am=window.setTimeout(S,250)}function S(){console.log("Resize");am=null;var ax=f.canvas.getBoundingClientRect();f.canvas.width=ax.width/o.pixelDiv;f.canvas.height=ax.height/o.pixelDiv;an=I(f.canvas.width,f.canvas.height);f.viewport(0,0,f.canvas.width,f.canvas.height);f.useProgram(U);f.uniformMatrix4fv(T,false,an);f.useProgram(at);f.uniform2f(f.getUniformLocation(at,"screenSize"),f.canvas.width,f.canvas.height);f.useProgram(null);f.bindTexture(f.TEXTURE_2D,aj.texture);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.canvas.width,f.canvas.height,0,f.RGBA,f.UNSIGNED_BYTE,null);f.bindTexture(f.TEXTURE_2D,null)}v=S}function i(N){N.preventDefault();cancelAnimationFrame(b);console.log("WebGL Context Lost")}function c(){console.log("WebGL Context Restored");z=0;u=0;x=0;H(e)}function w(){var N=f.getExtension("WEBGL_lose_context");N.loseContext();window.setTimeout(function(O){O.restoreContext()},1000,N)}function I(N,R){var P=1/(-N);var O=1/(-R);var S=1/(0-10);var Q=new Float32Array([-2*P,0,0,0,0,-2*O,0,0,0,0,2*S,0,N*P,R*O,10*S,1]);return Q}var z=0;var u=0;var x=0;var n=new Float32Array(x);function A(){var O,N;var P=0;for(O=0;O<E.length;O++){P+=E[O].vert.length}if(P>x){x=Math.ceil(P/d)*d;n=new Float32Array(x)}var Q=0;for(O=0;O<E.length;O++){for(N=0;N<E[O].vert.length;N++){n[Q++]=E[O].vert[N]}}z=Q}function L(){var O=f.createTexture();f.bindTexture(f.TEXTURE_2D,O);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.canvas.width,f.canvas.height,0,f.RGBA,f.UNSIGNED_BYTE,null);f.bindTexture(f.TEXTURE_2D,null);var N=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,N);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,O,0);f.bindFramebuffer(f.FRAMEBUFFER,null);return{buffer:N,texture:O}}var E=[];function h(P){if(E.length==0){E.push(new D())}var N=o.lineCount/(o.pixelDiv);var O;for(O=0;O<E.length;O++){E[O].update(P);if(E[O].done){E.splice(O,1)}}while(E.length<N){E.push(new D())}}function a(){for(var N=1;N<400;N++){h(0.1)}}function r(O,N){O=Math.ceil(O);N=Math.floor(N);return Math.floor(Math.random()*(N-O+1))+O}function k(O,N,P){return Math.max(N,Math.min(P,O))}function l(O,N,P){return O+P*(N-O)}function j(N){return 3*N*N-2*N*N*N}function D(N,Q){var O=f.canvas.width,P=f.canvas.height;this.pts=[];this.bias=r(1,4);this.done=false;this.last=0;this.bx=N||r(1,O/10)*10;this.by=Q||r(1,P/10)*10;this.px=this.bx;this.py=this.by;this.life=r(1,50)+50;this.w=10;this.pw=2.5;this.noReverse=(r(0,8)==1);this.vert=[];this.update=K;this.genMesh=G;this.lp=1;this.ndx=0;this.ndy=0}var M=20;var F=0;function K(P){F=F+P*2000*o.speed;if(this.lp<1){var V=Math.sqrt(this.ndx*this.ndx+this.ndy*this.ndy)*0.1;this.lp=this.lp+P*10*o.speed/V;if(this.lp>1){this.lp=1}var W=this.pts.length-1;var Z=this.pts[W];var U=l(0,this.ndx,j(this.lp));var T=l(0,this.ndy,j(this.lp));this.pts[W].x=U;this.pts[W].y=T;for(var S=0;S<this.pts.length;S++){var R=this.pts[S];if(R.ddo>R.o){this.pts[S].ddo=this.pts[S].ddo-255*P*o.speed*2}if(R.ddo<R.o){this.pts[S].ddo=R.o}if(R.ddo<0){this.pts[S].ddo=0}}this.genMesh();return}if(F<M){return}F=0;M=r(10,25)/o.speed;if(this.life==0&&this.pts.length==0){this.done=true;return}if(r(1,4)!=1){return}if(r(1,4)==1){if(this.pts.length!=0){this.bx=this.bx+this.pts[0].x;this.by=this.by+this.pts[0].y;this.pts.shift();this.genMesh()}}if(r(1,2)!=1){return}if(this.life==0){return}var O=this.bias+r(1,3)-1;var Y=0;var X=0;var N=r(1,6)*10;if(O>4){O=O-4}if(O<1){O=O+4}if((O==(this.last+2)%4)&&this.noReverse){O=(O+2)%4}if(O==1){X=-N}if(O==2){Y=N}if(O==3){X=N}if(O==4){Y=-N}this.pts.push({x:0,y:0,o:255,ddo:255});this.lp=0;this.ndx=Y;this.ndy=X;this.genMesh();this.px=this.px+Y;this.py=this.py+X;this.last=O;this.life=this.life-1;var Q=100;if(this.px<0-Q||this.px>f.canvas.width+Q){this.life=0}if(this.py<0-Q||this.py>f.canvas.height+Q){this.life=0}}function G(){this.vert=[];if(this.done||this.pts.length<2){return}var X=this.bx,W=this.by,S=0,R=0,T=0,V=0,Y=this.w,aa=this.pw,Q,P,Z=this.vert,N=0,U=0,O=0;for(Q=0;Q<this.pts.length;Q++){P=this.pts[Q];S=X+P.x;R=W+P.y;this.pts[Q].o=T;U=P.ddo;if(Q>0){Z[N++]=X-Y;Z[N++]=W-Y;Z[N++]=O;Z[N++]=X+Y;Z[N++]=W+Y;Z[N++]=O;Z[N++]=S-Y;Z[N++]=R-Y;Z[N++]=U;Z[N++]=X+Y;Z[N++]=W+Y;Z[N++]=O;Z[N++]=S+Y;Z[N++]=R+Y;Z[N++]=U;Z[N++]=S-Y;Z[N++]=R-Y;Z[N++]=U}O=U;V=T;T=T+(255/this.pts.length);X=S;W=R}}var g="precision highp float;attribute vec3 position;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;varying float opacity;void main() {	opacity = position.z/255.0;	gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 0.0, 1.0);}";var m="precision highp float;varying float opacity;uniform vec3 color;uniform float time;uniform float cycle;uniform float amount;vec3 pal( in float t, in vec3 a, in vec3 b, in vec3 c, in vec3 d ){    return a + b*cos( 6.28318*(c*t+d) );}vec3 aa = vec3(.5,.5,.5);vec3 bb = vec3(.5,.5,.5);vec3 cc = vec3(.5,.5,.5);vec3 dd = vec3(.2,.33,.67);void main() {	float amtx = (1.0+sin(1.8*time+gl_FragCoord.y*0.05)*sin(1.8*time+gl_FragCoord.x*0.07)*.3);	float amt2 = (1.0+sin(1.5*time+gl_FragCoord.y*0.007)*sin(1.8*time+gl_FragCoord.x*0.009)*.7);	vec3 ra = vec3(mod(cycle+.66,1.0),mod(cycle+.33,1.0),mod(cycle+.99,1.0));	vec3 ca = pal(opacity,aa,bb,cc,ra);	ca = mix(clamp(amtx*amt2,.7,1.5)*color, ca, amount);	gl_FragColor = vec4(ca, opacity);}";var J="precision highp float;attribute vec2 position;varying vec2 vTexCoord;void main() {	vTexCoord = (position + 1.0) / 2.0;	gl_Position = vec4(position.xy, 0.0, 1.0);}";var B="precision highp float;varying vec2 vTexCoord;uniform vec2 screenSize;uniform float time;uniform sampler2D texture;float rand(vec2 co){    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);}void main() {	float namt = 0.04;	vec3 noise = vec3(rand(vTexCoord+time));	vec4 samp = texture2D(texture, vTexCoord);	vec3 bl = mix(samp.rgb, noise, namt);	vec4 acolor = vec4(bl, samp.a);	float vmask = smoothstep(1.,.1,distance(vTexCoord, vec2(0.5,0.5)));	acolor.a = mix(0., acolor.a, vmask);	gl_FragColor = acolor;}";function C(N){o.cycleVal=(o.cycleVal+N*o.cycleSpeed)%1;o.lineColor=y(o.cycleVal,1,0.5);o.backColor=y((o.cycleVal+0.5)%1,1,0.03)}function y(S,V,R){var N,T,U;if(V==0){N=T=U=R}else{function Q(Y,X,W){if(W<0){W+=1}if(W>1){W-=1}if(W<1/6){return Y+(X-Y)*6*W}if(W<1/2){return X}if(W<2/3){return Y+(X-Y)*(2/3-W)*6}return Y}var O=R<0.5?R*(1+V):R+V-R*V;var P=2*R-O;N=Q(P,O,S+1/3);T=Q(P,O,S);U=Q(P,O,S-1/3)}return[N,T,U]}function q(N){switch(N){case 1:o.cycle=true;o.cycleVal=Math.random();o.cycleSpeed=o.customCycleSpeed;o.tint=0.01;o.backColor=[0.03,0.03,0.03];o.programMode=1;break;case 2:o.cycle=true;o.cycleVal=o.customCycleVal;o.cycleSpeed=0;o.tint=0.01;o.backColor=[0.03,0.03,0.03];o.programMode=2;break;default:break}}window.wallpaperPropertyListener={applyUserProperties:function(Q){if(Q.linecount){var R=Q.linecount.value;o.lineCount=R;var O=o.lineCount/(o.pixelDiv);while(E.length>O){E.pop()}}if(Q.movespeed){var S=Q.movespeed.value/100;o.speed=S}if(Q.irradiance){var P=Q.irradiance.value/100;o.irradiance=P}if(Q.colorset){q(Q.colorset.value);t=true}if(Q.cyclespeed){var T=Q.cyclespeed.value;o.customCycleSpeed=T/1000}if(Q.cycleval){var N=Q.cycleval.value;o.customCycleVal=N/359}if(Q.pixelsize){o.pixelDiv=k(Q.pixelsize.value,1,4)+2;v();E=[];a()}},applyGeneralProperties:function(N){if(N.fps){}}};function s(){var N=p();H(N)}s()})();
